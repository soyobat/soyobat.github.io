<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css" integrity="sha256-VHqXKFhhMxcpubYf9xiWdCiojEbY9NexQ4jh8AxbvcM=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.soyorin.online","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.26.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":10,"width":280,"onmobile":true},"hljswrap":true,"codeblock":{"theme":{"light":"default","dark":"stackoverflow-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac","show_result":true},"fold":{"enable":false,"height":500},"language":false,"highlight_theme":"night eighties"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="语法基础CURD1234INSERT INTO TABLE  (XXX)VALUE( XX,XX)SELECT XX FROM TABLE UPDATE TABLE SET &#x27;XX&#x27; &#x3D; XX WHEREDELETE FROM TABLE WHERE   查询DISTINCT(去重)12SELECT DISTINCT name, city FROM users;对(name,c">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL面试题">
<meta property="og:url" content="https://www.soyorin.online/2025/10/11/SQL%E9%9D%A2%E8%AF%95%E9%A2%98/index.html">
<meta property="og:site_name" content="soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site">
<meta property="og:description" content="语法基础CURD1234INSERT INTO TABLE  (XXX)VALUE( XX,XX)SELECT XX FROM TABLE UPDATE TABLE SET &#x27;XX&#x27; &#x3D; XX WHEREDELETE FROM TABLE WHERE   查询DISTINCT(去重)12SELECT DISTINCT name, city FROM users;对(name,c">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.soyorin.online/images/62e4c62a0bfdcfe030f3d70e4a6a3822.png">
<meta property="og:image" content="https://www.soyorin.online/images/d662a36877079f33f96905905d285e03.png">
<meta property="og:image" content="https://www.soyorin.online/images/5cdab91ab30be442fa136f396c9e360c.png">
<meta property="og:image" content="https://www.soyorin.online/images/3f29d31d2fa04422dcafa4714836cc5c.png">
<meta property="og:image" content="https://www.soyorin.online/images/dcab8a9a491b1dbf652b2177d1998373.png">
<meta property="og:image" content="https://www.soyorin.online/images/4925c107ae827ee914e2f827d07c37a4.png">
<meta property="og:image" content="https://www.soyorin.online/images/ae7213d6a910a27b61877742f0bff9ae.png">
<meta property="og:image" content="https://www.soyorin.online/images/bdcab7981bc69fbf371e58b3449bde43.png">
<meta property="og:image" content="https://www.soyorin.online/images/186b2a331eea95f5332d287b77f4d779.png">
<meta property="og:image" content="https://www.soyorin.online/images/52771237c3e7c0b573906c0dbfaaf580.png">
<meta property="article:published_time" content="2025-10-10T17:40:01.000Z">
<meta property="article:modified_time" content="2025-10-12T13:31:43.000Z">
<meta property="article:author" content="lkl">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="学习">
<meta property="article:tag" content="博客">
<meta property="article:tag" content="日常">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.soyorin.online/images/62e4c62a0bfdcfe030f3d70e4a6a3822.png">


<link rel="canonical" href="https://www.soyorin.online/2025/10/11/SQL%E9%9D%A2%E8%AF%95%E9%A2%98/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://www.soyorin.online/2025/10/11/SQL%E9%9D%A2%E8%AF%95%E9%A2%98/","path":"2025/10/11/SQL面试题/","title":"SQL面试题"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>SQL面试题 | soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site</title>
  








  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.5.0/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">ε=(´ο｀*)))唉，学Java的这辈子有了</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-友链"><a href="/link/" rel="section"><i class="fas fa-link fa-fw"></i>友链</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%AD%E6%B3%95%E5%9F%BA%E7%A1%80"><span class="nav-number">1.</span> <span class="nav-text">语法基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CURD"><span class="nav-number">1.1.</span> <span class="nav-text">CURD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.2.</span> <span class="nav-text">查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#DISTINCT-%E5%8E%BB%E9%87%8D"><span class="nav-number">1.2.1.</span> <span class="nav-text">DISTINCT(去重)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LIMIT"><span class="nav-number">1.2.2.</span> <span class="nav-text">LIMIT()</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-number">1.3.</span> <span class="nav-text">排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4"><span class="nav-number">1.4.</span> <span class="nav-text">过滤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">1.5.</span> <span class="nav-text">通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">1.6.</span> <span class="nav-text">计算字段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">1.7.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B1%87%E6%80%BB-%E9%87%8D%E8%A6%81"><span class="nav-number">1.7.1.</span> <span class="nav-text">汇总(重要)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F-%E6%96%87%E6%9C%AC"><span class="nav-number">1.7.2.</span> <span class="nav-text">日期&amp;文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E5%A4%84%E7%90%86"><span class="nav-number">1.7.3.</span> <span class="nav-text">数组处理</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">1.8.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%BB%84-%E9%87%8D%E8%A6%81"><span class="nav-number">1.9.</span> <span class="nav-text">分组!(重要)</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%84%E5%88%99"><span class="nav-number">1.9.1.</span> <span class="nav-text">规则</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.10.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.10.1.</span> <span class="nav-text">标量子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%EF%B8%8F%E2%83%A3-%E7%BB%93%E6%9E%84%E5%88%86%E6%9E%90"><span class="nav-number">1.10.1.1.</span> <span class="nav-text">1️⃣ 结构分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%EF%B8%8F%E2%83%A3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BF%9D%E8%AF%81%E4%B8%80%E8%A1%8C%E8%BE%93%E5%87%BA"><span class="nav-number">1.10.1.2.</span> <span class="nav-text">2️⃣ 为什么保证一行输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3%EF%B8%8F%E2%83%A3-%E5%AF%B9%E6%AF%94%E6%99%AE%E9%80%9A%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.10.1.3.</span> <span class="nav-text">3️⃣ 对比普通子查询</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4%EF%B8%8F%E2%83%A3-%E6%80%BB%E7%BB%93"><span class="nav-number">1.10.1.4.</span> <span class="nav-text">4️⃣ 总结</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.11.</span> <span class="nav-text">连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.11.1.</span> <span class="nav-text">内连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.11.2.</span> <span class="nav-text">自连接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="nav-number">1.11.3.</span> <span class="nav-text">外连接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">1.12.</span> <span class="nav-text">组合查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MYSQL-8-%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%EF%BC%88%E9%87%8D%E8%A6%81%EF%BC%89"><span class="nav-number">1.13.</span> <span class="nav-text">MYSQL 8 窗口函数（重要）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E7%94%A8%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0"><span class="nav-number">1.13.1.</span> <span class="nav-text">常用窗口函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3%E5%87%BD%E6%95%B0%E7%BB%86%E5%88%99"><span class="nav-number">1.13.2.</span> <span class="nav-text">窗口函数细则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OVER%E8%AF%AD%E6%B3%95"><span class="nav-number">1.13.3.</span> <span class="nav-text">OVER语法</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%A7%E5%8E%82%E7%9C%9F%E9%A2%98"><span class="nav-number">2.</span> <span class="nav-text">大厂真题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BE%E5%BA%A6"><span class="nav-number">2.1.</span> <span class="nav-text">百度</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2021%E5%B9%B411%E6%9C%88%E6%AF%8F%E5%A4%A9%E7%9A%84%E4%BA%BA%E5%9D%87%E6%B5%8F%E8%A7%88%E6%96%87%E7%AB%A0%E6%97%B6%E9%95%BF-%E7%89%9B%E5%AE%A2%E9%A2%98%E9%9C%B8-%E7%89%9B%E5%AE%A2%E7%BD%91"><span class="nav-number">2.1.1.</span> <span class="nav-text">2021年11月每天的人均浏览文章时长_牛客题霸_牛客网</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sum-out-time-in-time-count-distinct-uid-as-avg-time-where-%E6%9C%88%E4%BB%BD-group-by-day-order-by-avg-time"><span class="nav-number"></span> <span class="nav-text">sum(out_time - in_time) &#x2F; count(distinct uid)   as avg_time where 月份 group by day order by avg_time</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#SQL-50"><span class="nav-number">1.</span> <span class="nav-text">SQL 50</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#-1"><span class="nav-number">1.1.</span> <span class="nav-text"></span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lkl"
      src="/images/boqi.jpg">
  <p class="site-author-name" itemprop="name">lkl</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">441</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/soyobat" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;soyobat" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.soyorin.online/2025/10/11/SQL%E9%9D%A2%E8%AF%95%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/boqi.jpg">
      <meta itemprop="name" content="lkl">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="SQL面试题 | soyo的跨机房部署、同城双活、异地多活、9个9高可用博客yuque笔记同步site">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SQL面试题
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2025-10-11 01:40:01" itemprop="dateCreated datePublished" datetime="2025-10-11T01:40:01+08:00">2025-10-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-12 21:31:43" itemprop="dateModified" datetime="2025-10-12T21:31:43+08:00">2025-10-12</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="语法基础"><a href="#语法基础" class="headerlink" title="语法基础"></a>语法基础</h2><h3 id="CURD"><a href="#CURD" class="headerlink" title="CURD"></a>CURD</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> <span class="keyword">TABLE</span>  (XXX)<span class="keyword">VALUE</span>( XX,XX)</span><br><span class="line"><span class="keyword">SELECT</span> XX <span class="keyword">FROM</span> <span class="keyword">TABLE</span> </span><br><span class="line"><span class="keyword">UPDATE</span> <span class="keyword">TABLE</span> <span class="keyword">SET</span> <span class="string">&#x27;XX&#x27;</span> <span class="operator">=</span> XX <span class="keyword">WHERE</span></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="keyword">TABLE</span> <span class="keyword">WHERE</span> </span><br></pre></td></tr></table></figure>

<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><h4 id="DISTINCT-去重"><a href="#DISTINCT-去重" class="headerlink" title="DISTINCT(去重)"></a>DISTINCT(去重)</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> name, city <span class="keyword">FROM</span> users;</span><br><span class="line">对(name,city) 所有列去重，即<span class="keyword">sql</span>语句里写的</span><br></pre></td></tr></table></figure>

<h4 id="LIMIT"><a href="#LIMIT" class="headerlink" title="LIMIT()"></a>LIMIT()</h4><p>限制返回的行数。<font style="color:rgb(44, 62, 80);">第一个参数为起始行，从 0 开始；第二个参数为返回的总行数</font></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span><span class="operator">/</span>返回前<span class="number">5</span>行</span><br><span class="line"><span class="keyword">SELECT</span> city,name <span class="keyword">FROM</span> <span class="keyword">TABLE</span> LIMIT <span class="number">5</span>;</span><br><span class="line"><span class="keyword">SELECT</span> city,name <span class="keyword">FROM</span> <span class="keyword">TABLE</span> LIMIT <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>返回<span class="number">2</span><span class="number">-5</span>行</span><br><span class="line"><span class="keyword">SELECT</span> city,name <span class="keyword">FROM</span> <span class="keyword">TABLE</span> LIMIT <span class="number">2</span>,<span class="number">3</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h3><ul>
<li>ASC：升序</li>
<li>DESC：降序</li>
</ul>
<p><font style="color:rgb(44, 62, 80);">可以按多个列进行排序，并且为每个列指定不同的排序方式:</font></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> col1 <span class="keyword">DESC</span>, col2 <span class="keyword">ASC</span>;</span><br></pre></td></tr></table></figure>

<h3 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a><font style="color:rgb(44, 62, 80);">过滤</font></h3><table>
<thead>
<tr>
<th>操作符</th>
<th>示例 SQL</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>=</code></td>
<td><code>SELECT * FROM students WHERE city = &#39;北京&#39;;</code></td>
<td>等于</td>
</tr>
<tr>
<td><code>&lt;</code></td>
<td><code>SELECT * FROM students WHERE age &lt; 20;</code></td>
<td>小于</td>
</tr>
<tr>
<td><code>&gt;</code></td>
<td><code>SELECT * FROM students WHERE score &gt; 90;</code></td>
<td>大于</td>
</tr>
<tr>
<td><code>&lt;&gt;</code> 或 <code>!=</code></td>
<td><code>SELECT * FROM students WHERE city &lt;&gt; &#39;北京&#39;;</code></td>
<td>不等于</td>
</tr>
<tr>
<td><code>&lt;=</code> &#x2F; <code>!&gt;</code></td>
<td><code>SELECT * FROM students WHERE age &lt;= 18;</code></td>
<td>小于等于</td>
</tr>
<tr>
<td><code>&gt;=</code> &#x2F; <code>!&lt;</code></td>
<td><code>SELECT * FROM students WHERE score &gt;= 90;</code></td>
<td>大于等于</td>
</tr>
<tr>
<td><code>BETWEEN</code></td>
<td><code>SELECT * FROM students WHERE score BETWEEN 80 AND 90;</code></td>
<td>在两值之间（包含边界）</td>
</tr>
<tr>
<td><code>IS NULL</code></td>
<td><code>SELECT * FROM students WHERE remark IS NULL;</code></td>
<td>是 NULL</td>
</tr>
<tr>
<td><code>IS NOT NULL</code></td>
<td><code>SELECT * FROM students WHERE remark IS NOT NULL;</code></td>
<td>不是 NULL</td>
</tr>
<tr>
<td><code>AND</code></td>
<td><code>SELECT * FROM students WHERE age &gt; 18 AND score &gt; 80;</code></td>
<td>同时满足两个条件</td>
</tr>
<tr>
<td><code>OR</code></td>
<td><code>SELECT * FROM students WHERE city = &#39;北京&#39; OR city = &#39;上海&#39;;</code></td>
<td>满足任一条件</td>
</tr>
<tr>
<td><code>()</code> 优先级</td>
<td><code>SELECT * FROM students WHERE city=&#39;北京&#39; OR (age &lt; 20 AND score &gt; 80);</code></td>
<td>加括号调整逻辑</td>
</tr>
<tr>
<td><code>IN</code></td>
<td><code>SELECT * FROM students WHERE city IN (&#39;北京&#39;, &#39;上海&#39;);</code></td>
<td>等价于多个 OR</td>
</tr>
<tr>
<td><code>IN (SELECT ...)</code></td>
<td><code>SELECT * FROM students WHERE id IN (SELECT id FROM scores WHERE score&gt;90);</code></td>
<td>从子查询匹配</td>
</tr>
<tr>
<td><code>NOT</code></td>
<td><code>SELECT * FROM students WHERE NOT city = &#39;北京&#39;;</code></td>
<td>否定条件</td>
</tr>
</tbody></table>
<h3 id="通配符"><a href="#通配符" class="headerlink" title="通配符"></a><font style="color:rgb(44, 62, 80);">通配符</font></h3><table>
<thead>
<tr>
<th>通配符</th>
<th>示例 SQL</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><code>%</code>（&gt;&#x3D;0 个字符）</td>
<td><code>SELECT * FROM students WHERE name LIKE &#39;张%&#39;;</code></td>
<td>匹配所有<strong>以“张”开头</strong>的名字，例如“张三”、“张小明”</td>
</tr>
<tr>
<td><code>%abc%</code></td>
<td><code>SELECT * FROM students WHERE city LIKE &#39;%京%&#39;;</code></td>
<td>匹配<strong>包含“京”</strong> 的城市，例如“北京”、“南京”</td>
</tr>
<tr>
<td><code>_</code>（&#x3D;1 个字符）</td>
<td><code>SELECT * FROM students WHERE name LIKE &#39;_三&#39;;</code></td>
<td>匹配<strong>第二个字是“三”的两个字名字</strong>，如“张三”，但不匹配“王小三”</td>
</tr>
<tr>
<td><code>[ab]</code></td>
<td><code>SELECT * FROM students WHERE name LIKE &#39;[李王]%&#39;;</code> <em>(部分数据库支持，如 SQL Server)</em></td>
<td>匹配<strong>姓李或姓王</strong>的学生</td>
</tr>
<tr>
<td><code>[^ab]</code></td>
<td><code>SELECT * FROM students WHERE name LIKE &#39;[^李王]%&#39;</code>;</td>
<td>匹配<strong>不姓李也不姓王</strong>的学生</td>
</tr>
</tbody></table>
<h3 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a><font style="color:rgb(44, 62, 80);">计算字段</font></h3><p><img src="/images/62e4c62a0bfdcfe030f3d70e4a6a3822.png"></p>
<p><img src="/images/d662a36877079f33f96905905d285e03.png"></p>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><h4 id="汇总-重要"><a href="#汇总-重要" class="headerlink" title="汇总(重要)"></a>汇总(重要)</h4><table>
<thead>
<tr>
<th>汇总函数</th>
<th>作用</th>
<th>示例 SQL</th>
<th>示例结果</th>
</tr>
</thead>
<tbody><tr>
<td><code>COUNT(*)</code></td>
<td>计算总行数（包含 NULL）</td>
<td><code>SELECT COUNT(*) FROM students;</code></td>
<td><code>5</code></td>
</tr>
<tr>
<td><code>COUNT(col)</code></td>
<td>统计非 NULL 的个数</td>
<td><code>SELECT COUNT(score) FROM students;</code></td>
<td><code>4</code>（NULL 被忽略）</td>
</tr>
<tr>
<td><code>AVG(col)</code></td>
<td>计算平均值（忽略 NULL）</td>
<td><code>SELECT AVG(score) FROM students;</code></td>
<td><code>(85+90+75+95) / 4 = 86.25</code></td>
</tr>
<tr>
<td><code>SUM(col)</code></td>
<td>求和（忽略 NULL）</td>
<td><code>SELECT SUM(score) FROM students;</code></td>
<td><code>85+90+75+95 = 345</code></td>
</tr>
<tr>
<td><code>MAX(col)</code></td>
<td>最大值</td>
<td><code>SELECT MAX(score) FROM students;</code></td>
<td><code>95</code></td>
</tr>
<tr>
<td><code>MIN(col)</code></td>
<td>最小值</td>
<td><code>SELECT MIN(score) FROM students;</code></td>
<td><code>75</code></td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">AVG</span><br><span class="line">SUM</span><br><span class="line">MIN</span><br><span class="line">MAX</span><br><span class="line"><span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="operator">/</span><span class="operator">/</span>统计全部</span><br><span class="line"><span class="built_in">COUNT</span>(col) <span class="operator">/</span><span class="operator">/</span>统计非空</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/images/5cdab91ab30be442fa136f396c9e360c.png">、</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ACG( <span class="keyword">DISTINCT</span> col) 只会对不同的col做汇总</span><br></pre></td></tr></table></figure>



<h4 id="日期-文本"><a href="#日期-文本" class="headerlink" title="日期&amp;文本"></a>日期&amp;文本</h4><h4 id="数组处理"><a href="#数组处理" class="headerlink" title="数组处理"></a>数组处理</h4><h3 id=""><a href="#" class="headerlink" title=""></a><img src="/images/3f29d31d2fa04422dcafa4714836cc5c.png"></h3><h3 id="分组-重要"><a href="#分组-重要" class="headerlink" title="分组!(重要)"></a>分组!(重要)</h3><p>分组 其实就是把相同的数据值的行放到同一组中</p>
<p>通过我们会要求 返回的是每一组的一个汇总情况</p>
<p><font style="color:rgb(44, 62, 80);">指定的分组字段除了能按该字段进行分组，也会自动按该字段进行排序。即group by会自动排序</font></p>
<p><strong><font style="color:rgb(44, 62, 80);">WHERE 过滤行，HAVING 过滤分组</font></strong><font style="color:rgb(44, 62, 80);">，行过滤应当先于分组过滤。</font></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cal,<span class="built_in">SUM</span>(age) <span class="keyword">AS</span> cnt <span class="keyword">FROM</span> <span class="keyword">TABLE</span> </span><br><span class="line">  <span class="keyword">WHERE</span> name <span class="keyword">LIKE</span> <span class="string">&#x27;XX%&#x27;</span> </span><br><span class="line">  <span class="keyword">GROUP</span> <span class="keyword">BY</span> cal </span><br><span class="line">  <span class="keyword">ORDER</span> <span class="keyword">BY</span> xxx  </span><br><span class="line">  <span class="keyword">HAVING</span> cnt <span class="operator">&gt;</span> <span class="number">2</span>  </span><br></pre></td></tr></table></figure>

<p><img src="/images/dcab8a9a491b1dbf652b2177d1998373.png"></p>
<h4 id="规则"><a href="#规则" class="headerlink" title="规则"></a>规则</h4><ol>
<li>除了那个汇总字段外，select里出现的字段都应该在 group by中给出</li>
</ol>
<p><img src="/images/4925c107ae827ee914e2f827d07c37a4.png"></p>
<ol start="2">
<li>order by 应该在 group by之后</li>
</ol>
<p><img src="/images/ae7213d6a910a27b61877742f0bff9ae.png"></p>
<ol start="3">
<li><font style="color:rgb(44, 62, 80);">NULL 的行会单独分为一组；</font></li>
<li><font style="color:rgb(44, 62, 80);">MySQL 的group by不支持blog text，其实大多数 SQL 实现不支持 GROUP BY 列具有可变长度的数据类型。PS：char()为固定，varchar()为可变</font></li>
</ol>
<font style="color:rgb(44, 62, 80);">  
</font><font style="color:rgb(44, 62, 80);"> </font>

<p><img src="/images/bdcab7981bc69fbf371e58b3449bde43.png"></p>
<h3 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a><font style="color:rgb(44, 62, 80);">子查询</font></h3><p><strong>！！！子查询只能返回一个字段的数据</strong></p>
<p>可以将子查询的结果作为 WHRER 语句的过滤条件:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> mytable1</span><br><span class="line"><span class="keyword">WHERE</span> col1 <span class="keyword">IN</span> (<span class="keyword">SELECT</span> col2</span><br><span class="line">               <span class="keyword">FROM</span> mytable2);</span><br></pre></td></tr></table></figure>

<p>下面的语句可以检索出客户的订单数量，子查询语句会对第一个查询检索出的每个客户执行一次:</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> cust_name, (<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">                   <span class="keyword">FROM</span> Orders</span><br><span class="line">                   <span class="keyword">WHERE</span> Orders.cust_id <span class="operator">=</span> Customers.cust_id)</span><br><span class="line">                   <span class="keyword">AS</span> orders_num</span><br><span class="line"><span class="keyword">FROM</span> Customers</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> cust_name;</span><br></pre></td></tr></table></figure>

<h4 id="标量子查询"><a href="#标量子查询" class="headerlink" title="标量子查询"></a>标量子查询</h4><h5 id="1️⃣-结构分析"><a href="#1️⃣-结构分析" class="headerlink" title="1️⃣ 结构分析"></a>1️⃣ 结构分析</h5><ol>
<li><strong>外层 SELECT</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT (子查询) AS SecondHighestSalary</span><br></pre></td></tr></table></figure>

<ul>
<li>外层 SELECT 里只有一个表达式：一个 <strong>标量子查询</strong></li>
<li><strong>标量子查询</strong>（scalar subquery）返回 <strong>单个值</strong></li>
<li>即使没有匹配的行，MySQL 也会返回一行，值为 <code>NULL</code></li>
</ul>
<ol>
<li><strong>子查询</strong></li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT salary FROM Rank_S WHERE sRank = 2 LIMIT 1</span><br></pre></td></tr></table></figure>

<ul>
<li>查找 <code>sRank = 2</code> 的工资</li>
<li>如果存在多行（同一工资多个员工），<code>LIMIT 1</code> 保证只取 <strong>一行</strong></li>
<li>如果不存在第二高工资（比如表里只有一条记录），子查询 <strong>不返回任何行</strong> → 标量子查询自动返回 <strong>NULL</strong></li>
</ul>
<hr>
<h5 id="2️⃣-为什么保证一行输出"><a href="#2️⃣-为什么保证一行输出" class="headerlink" title="2️⃣ 为什么保证一行输出"></a>2️⃣ 为什么保证一行输出</h5><ul>
<li><strong>外层 SELECT</strong> 不依赖表，只是用标量子查询生成一列</li>
<li>MySQL 规则：</li>
</ul>
<p>标量子查询如果没有返回值 → 结果为 <code>NULL</code></p>
<ul>
<li>外层 SELECT 至少会输出一行（列名 SecondHighestSalary，值为 NULL 或工资值）</li>
</ul>
<hr>
<h5 id="3️⃣-对比普通子查询"><a href="#3️⃣-对比普通子查询" class="headerlink" title="3️⃣ 对比普通子查询"></a>3️⃣ 对比普通子查询</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT salary FROM Rank_S WHERE sRank = 2;</span><br></pre></td></tr></table></figure>

<ul>
<li>直接查询，没找到行 → <strong>返回 0 行</strong></li>
<li>不是标量子查询，外层没有包裹 → 可能没有任何结果行</li>
</ul>
<hr>
<h5 id="4️⃣-总结"><a href="#4️⃣-总结" class="headerlink" title="4️⃣ 总结"></a>4️⃣ 总结</h5><ul>
<li><strong>标量子查询 + 外层 SELECT</strong> → 总是返回一行</li>
<li><strong>LIMIT 1</strong> 保证即使有多行，也只取一行</li>
<li><strong>没有匹配值</strong> → 返回 NULL</li>
<li>✅ 这就是为什么你写法“即使没有第二名，也会返回一行结果”</li>
</ul>
<h3 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h3><p>连接用于连接多个表，使用 JOIN 关键字，并且条件语句使用 ON 而不是 WHERE。</p>
<p>连接可以替换子查询，并且比子查询的效率一般会更快。</p>
<p>可以用 AS 给列名、计算字段和表名取别名，给表名取别名是为了简化 SQL 语句以及连接相同表</p>
<p>其实就是根据某个条件把两张表的数据给拼接到一起</p>
<h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4><p>eg：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value <span class="keyword">AS</span> A_value, B.value <span class="keyword">AS</span> B_value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> tableb <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">ON</span> A.key <span class="operator">=</span> B.key;</span><br></pre></td></tr></table></figure>

<p><img src="/images/186b2a331eea95f5332d287b77f4d779.png"></p>
<p><img src="/images/52771237c3e7c0b573906c0dbfaaf580.png"></p>
<p>可以不明确使用 INNER JOIN，而使用普通查询并在 WHERE 中将两个表中要连接的列用等值方法连接起来。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> A.value, B.value</span><br><span class="line"><span class="keyword">FROM</span> tablea <span class="keyword">AS</span> A, tableb <span class="keyword">AS</span> B</span><br><span class="line"><span class="keyword">WHERE</span> A.key <span class="operator">=</span> B.key;</span><br></pre></td></tr></table></figure>

<p>在没有条件语句的情况下返回笛卡尔积</p>
<p>PS：内连接；<font style="color:rgb(44, 62, 80);">在没有条件语句的情况下返回笛卡尔积。</font></p>
<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4><p>自连接可以看成内连接的一种，只是连接的表是自身而已。</p>
<p>一张员工表，包含员工姓名和员工所属部门，要找出与 Jim 处在同一部门的所有员工姓名。</p>
<p>子查询版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> name</span><br><span class="line"><span class="keyword">FROM</span> employee</span><br><span class="line"><span class="keyword">WHERE</span> department <span class="operator">=</span> (</span><br><span class="line">      <span class="keyword">SELECT</span> department</span><br><span class="line">      <span class="keyword">FROM</span> employee</span><br><span class="line">      <span class="keyword">WHERE</span> name <span class="operator">=</span> &quot;Jim&quot;);</span><br></pre></td></tr></table></figure>

<p>自连接版本</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> e1.name</span><br><span class="line"><span class="keyword">FROM</span> employee <span class="keyword">AS</span> e1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> employee <span class="keyword">AS</span> e2</span><br><span class="line"><span class="keyword">ON</span> e1.department <span class="operator">=</span> e2.department</span><br><span class="line">      <span class="keyword">AND</span> e2.name <span class="operator">=</span> &quot;Jim&quot;;</span><br></pre></td></tr></table></figure>



<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ON</span> e1.department <span class="operator">=</span> e2.department</span><br><span class="line">   <span class="keyword">AND</span> e2.name <span class="operator">=</span> &quot;Jim&quot;</span><br></pre></td></tr></table></figure>

<p>解释：</p>
<p>e1.department &#x3D; e2.department：找和某人同部门的员工</p>
<p>e2.name &#x3D; “Jim”：指定 e2 这一行是 “Jim”</p>
<p>换句话说，就是：查找和 Jim 在同一个部门的所有员工。</p>
<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4><p>外连接保留了没有关联的那些行。分为左外连接，右外连接以及全外连接，左外连接就是保留左表没有关联的行。</p>
<p>检索所有顾客的订单信息，包括还没有订单信息的顾客。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Customers.cust_id, Orders.order_num</span><br><span class="line"><span class="keyword">FROM</span> Customers <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> Orders</span><br><span class="line"><span class="keyword">ON</span> Customers.cust_id <span class="operator">=</span> Orders.cust_id;</span><br></pre></td></tr></table></figure>

<p>customers 表:</p>
<table>
<thead>
<tr>
<th align="center">cust_id</th>
<th align="center">cust_name</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">b</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
</tr>
</tbody></table>
<p>orders 表:</p>
<table>
<thead>
<tr>
<th align="center">order_id</th>
<th align="center">cust_id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">3</td>
</tr>
</tbody></table>
<p>结果:</p>
<table>
<thead>
<tr>
<th align="center">cust_id</th>
<th align="center">cust_name</th>
<th align="center">order_id</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center">a</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">a</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">c</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">b</td>
<td align="center">Null</td>
</tr>
</tbody></table>
<h3 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h3><p>使用 <strong>UNION</strong> 来组合两个查询，如果第一个查询返回 M 行，第二个查询返回 N 行，那么组合查询的结果一般为 M+N 行。</p>
<p>每个查询必须包含相同的列、表达式和聚集函数。</p>
<p>默认会去除相同行，如果需要保留相同行，使用 UNION ALL。</p>
<p>只能包含一个 ORDER BY 子句，并且必须位于语句的最后。</p>
<p>总结：</p>
<ul>
<li><strong>合并两个或多个 SELECT 查询的结果</strong></li>
<li>默认会 <strong>去掉重复行</strong></li>
<li>如果想保留重复行，用 <code>UNION ALL</code></li>
<li><strong>要求</strong>：<ol>
<li>每个查询的列数必须相同</li>
<li>对应列的数据类型要兼容</li>
</ol>
</li>
<li><strong>ORDER BY</strong> 只能在最后使用一次</li>
</ul>
<p>可以理解为把查询结果 <strong>“上下拼接在一起”</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> col</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> col <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> col</span><br><span class="line"><span class="keyword">FROM</span> mytable</span><br><span class="line"><span class="keyword">WHERE</span> col <span class="operator">=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>



<h3 id="MYSQL-8-窗口函数（重要）"><a href="#MYSQL-8-窗口函数（重要）" class="headerlink" title="MYSQL 8 窗口函数（重要）"></a>MYSQL 8 窗口函数（重要）</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/shoshana-kong/p/16621254.html">MySQL六种窗口函数用法案例 - 白露~ - 博客园</a></p>
<p>窗口函数（Window Function）是 SQL 中用于<strong>在不分组的前提下对行进行计算</strong>的强大功能，尤其适用于排名、累计求和、移动平均等场景。</p>
<h4 id="常用窗口函数"><a href="#常用窗口函数" class="headerlink" title="常用窗口函数"></a>常用窗口函数</h4><table>
<thead>
<tr>
<th>分类</th>
<th>函数</th>
<th>常见用途</th>
</tr>
</thead>
<tbody><tr>
<td><strong>累计&#x2F;聚合</strong></td>
<td><code>SUM()</code>, <code>AVG()</code>, <code>COUNT()</code>, <code>MAX()</code>, <code>MIN()</code></td>
<td>累计和 &#x2F; 移动平均</td>
</tr>
<tr>
<td><strong>排序 &#x2F; 排名</strong></td>
<td><code>ROW_NUMBER()</code>, <code>RANK()</code>, <code>DENSE_RANK()</code></td>
<td>Top N、去重排序</td>
</tr>
<tr>
<td><strong>偏移比较</strong></td>
<td><code>LAG()</code>, <code>LEAD()</code></td>
<td>比较当前行与上一&#x2F;下一行</td>
</tr>
<tr>
<td><strong>统计总数</strong></td>
<td><code>NTILE()</code></td>
<td>分组分位（如四分位）</td>
</tr>
</tbody></table>
<h4 id="窗口函数细则"><a href="#窗口函数细则" class="headerlink" title="窗口函数细则"></a>窗口函数细则</h4><table>
<thead>
<tr>
<th>分类</th>
<th>函数</th>
<th>典型语法</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td><strong>累计 &#x2F; 聚合</strong></td>
<td><code>SUM(expr)</code></td>
<td><code>SUM(weight) OVER (ORDER BY turn)</code></td>
<td>累积求和</td>
</tr>
<tr>
<td></td>
<td><code>AVG(expr)</code></td>
<td><code>AVG(score) OVER (PARTITION BY class)</code></td>
<td>组内平均</td>
</tr>
<tr>
<td></td>
<td><code>COUNT(expr)</code></td>
<td><code>COUNT(*) OVER (ORDER BY date)</code></td>
<td>累计计数</td>
</tr>
<tr>
<td></td>
<td><code>MAX(expr)</code></td>
<td><code>MAX(salary) OVER (PARTITION BY dept)</code></td>
<td>每组最大值</td>
</tr>
<tr>
<td></td>
<td><code>MIN(expr)</code></td>
<td><code>MIN(salary) OVER ()</code></td>
<td>全局最小值</td>
</tr>
<tr>
<td><strong>排序 &#x2F; 排名</strong></td>
<td><code>ROW_NUMBER()</code></td>
<td><code>ROW_NUMBER() OVER (PARTITION BY dept ORDER BY salary DESC)</code></td>
<td>连续排名（无并列）</td>
</tr>
<tr>
<td></td>
<td><code>RANK()</code></td>
<td><code>RANK() OVER (ORDER BY score DESC)</code></td>
<td>有并列，跳号</td>
</tr>
<tr>
<td></td>
<td><code>DENSE_RANK()</code></td>
<td><code>DENSE_RANK() OVER (ORDER BY score DESC)</code></td>
<td>有并列，不跳号</td>
</tr>
<tr>
<td><strong>偏移比较</strong></td>
<td><code>LAG(expr, offset, default)</code></td>
<td><code>LAG(salary, 1, 0) OVER (ORDER BY id)</code></td>
<td>取上一行数据</td>
</tr>
<tr>
<td></td>
<td><code>LEAD(expr, offset, default)</code></td>
<td><code>LEAD(salary) OVER (ORDER BY id)</code></td>
<td>取下一行数据</td>
</tr>
<tr>
<td><strong>分布统计</strong></td>
<td><code>NTILE(n)</code></td>
<td><code>NTILE(4) OVER (ORDER BY score DESC)</code></td>
<td>分成 4 份（四分位）</td>
</tr>
<tr>
<td></td>
<td><code>PERCENT_RANK()</code></td>
<td><code>PERCENT_RANK() OVER (ORDER BY score)</code></td>
<td>百分比排名</td>
</tr>
<tr>
<td></td>
<td><code>CUME_DIST()</code></td>
<td><code>CUME_DIST() OVER (ORDER BY score)</code></td>
<td>累计分布比例</td>
</tr>
<tr>
<td><strong>位置 &#x2F; 首尾</strong></td>
<td><code>FIRST_VALUE(expr)</code></td>
<td><code>FIRST_VALUE(salary) OVER (PARTITION BY dept ORDER BY salary)</code></td>
<td>组内第一个</td>
</tr>
<tr>
<td></td>
<td><code>LAST_VALUE(expr)</code></td>
<td><code>LAST_VALUE(salary) OVER (...)</code></td>
<td>默认要配 frame 子句</td>
</tr>
<tr>
<td></td>
<td><code>NTH_VALUE(expr, n)</code></td>
<td><code>NTH_VALUE(score, 2) OVER (...)</code></td>
<td>取第 n 个</td>
</tr>
</tbody></table>
<h4 id="OVER语法"><a href="#OVER语法" class="headerlink" title="OVER语法"></a>OVER语法</h4><p>OVER，<code>OVER</code> 里只能出现 <code>PARTITION BY</code> 和 <code>ORDER BY</code></p>
<table>
<thead>
<tr>
<th>写法</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td><code>OVER()</code></td>
<td>不分组也不排序，整个表算</td>
</tr>
<tr>
<td><code>OVER(PARTITION BY ...)</code></td>
<td>在每个组内计算</td>
</tr>
<tr>
<td><code>OVER(ORDER BY ...)</code></td>
<td>按顺序逐行累积</td>
</tr>
<tr>
<td><code>OVER(PARTITION BY ... ORDER BY ...)</code></td>
<td>分组后再排序计算</td>
</tr>
</tbody></table>
<h2 id="大厂真题"><a href="#大厂真题" class="headerlink" title="大厂真题"></a>大厂真题</h2><h3 id="百度"><a href="#百度" class="headerlink" title="百度"></a>百度</h3><h4 id="2021年11月每天的人均浏览文章时长-牛客题霸-牛客网"><a href="#2021年11月每天的人均浏览文章时长-牛客题霸-牛客网" class="headerlink" title="2021年11月每天的人均浏览文章时长_牛客题霸_牛客网"></a><a target="_blank" rel="noopener" href="https://www.nowcoder.com/share/jump/1715904441760249304550">2021年11月每天的人均浏览文章时长_牛客题霸_牛客网</a></h4><p>统计2021年11月每天的人均浏览文章时长（秒数），结果保留1位小数，并按时长由短到长排序</p>
<p>分析： </p>
<p>:::info</p>
<h1 id="sum-out-time-in-time-count-distinct-uid-as-avg-time-where-月份-group-by-day-order-by-avg-time"><a href="#sum-out-time-in-time-count-distinct-uid-as-avg-time-where-月份-group-by-day-order-by-avg-time" class="headerlink" title="sum(out_time - in_time) &#x2F; count(distinct uid)   as avg_time where 月份 group by day order by avg_time"></a>sum(out_time - in_time) &#x2F; count(distinct uid)   as avg_time where 月份 group by day order by avg_time</h1><p>函数使用：</p>
<p>人均：sum(out_time - in_time) &#x2F; count(distinct uid)</p>
<p>每天的：group by day</p>
<p>2021年11月：where date_time() &#x3D; “”</p>
<p>保留1位小数：Round(  value,1)</p>
<p>:::</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="SQL-50"><a href="#SQL-50" class="headerlink" title="SQL 50"></a>SQL 50</h2><h3 id="-1"><a href="#-1" class="headerlink" title=""></a></h3>
    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>lkl
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://www.soyorin.online/2025/10/11/SQL%E9%9D%A2%E8%AF%95%E9%A2%98/" title="SQL面试题">https://www.soyorin.online/2025/10/11/SQL面试题/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/username">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/channel_name">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.png">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/10/11/%E6%89%8B%E5%86%99%E7%B3%BB%E5%88%97/%E6%97%A0%E6%A0%87%E9%A2%98%E6%96%87%E6%A1%A3/" rel="prev" title="无标题文档">
                  <i class="fa fa-angle-left"></i> 无标题文档
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/10/11/%E5%9C%BA%E6%99%AF%E9%A2%98/%E5%BC%80%E6%94%BE%E5%BC%8F%E6%95%B0%E6%8D%AE%E9%87%8F%E7%BA%A7%E9%97%AE%E9%A2%98/" rel="next" title="开放式数据量级问题">
                  开放式数据量级问题 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">lkl</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/soyobat" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</body>
</html>
